---
title: Vue父子组件之间传递参数
excerpt: 'Java'
tags: [Java]
categories: [Java]
comments: true
date: 2021-02-02 19:30:52
---

今天要把一个页面的dialog提出来，做成一个vue组件（component），共多个页面复用。
之前我知道如何向封装的组件中传递参数：

```html

  <intention-editor ref="intentionEditor" :bill-code="billCode" :edit-visible="editVisible" :is-db-edit="isDbEdit" @cancelEditor="cancelEditorFn"></intention-editor>

```

可是`intention-editor`中的dialog关闭的时候，要将和`:visible.sync`绑定的变量修改为false，这时候组件内的变量已经修改为false，上层页面的对应变量，也就是上面的`editVisible`却没有跟着变成false。之前有用过Vue的Bus实现过组件的通信，但是在这里用感觉太重了，后来问了同事，找到了下面的办法----`$emit`。

1、父组件可以使用`props`把数据传给子组件。
2、子组件可以使用`$emit`触发父组件的自定义事件。

```js

vm.$emit( event, arg ) //触发当前实例上的事件

vm.$on( event, fn );//监听event事件后运行 fn；

```

例如：子组件：
```html
<template>
  <div class="train-city">
    <h3>父组件传给子组件的toCity:{{sendData}}</h3> 
    <br/><button @click='select(`大连`)'>点击此处将‘大连’发射给父组件</button>
  </div>
</template>
<script>
  export default {
    name:'trainCity',
    props:['sendData'], // 用来接收父组件传给子组件的数据
    methods:{
      select(val) {
        let data = {
          cityname: val
        };
        this.$emit('showCityName',data);//select事件触发后，自动触发showCityName事件
      }
    }
  }
</script>
```
父组件：
```html
<template>
    <div>
        <div>父组件的toCity{{toCity}}</div>
        <train-city @showCityName="updateCity" :sendData="toCity"></train-city>
    </div>
<template>
<script>
  import TrainCity from "./train-city";
  export default {
    name:'index',
    components: {TrainCity},
    data () {
      return {
        toCity:"北京"
      }
    },
    methods:{
      updateCity(data){//触发子组件城市选择-选择城市的事件
        this.toCity = data.cityname;//改变了父组件的值
        console.log('toCity:'+this.toCity)
      }
    }
  }
</script>
```
